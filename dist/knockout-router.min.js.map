{"version":3,"file":null,"sources":["../node_modules/rollup-plugin-typescript/src/typescript-helpers.js","../src/utils.ts","../src/route.ts","../src/bindings.ts","../src/router.ts","../node_modules/qs/lib/utils.js","../node_modules/qs/lib/stringify.js","../node_modules/qs/lib/parse.js","../node_modules/qs/lib/index.js","../src/context.ts","../node_modules/path-to-regexp/node_modules/isarray/index.js","../node_modules/path-to-regexp/index.js"],"sourcesContent":["export const __assign = Object.assign || function (target) {\n    for (var source, i = 1; i < arguments.length; i++) {\n        source = arguments[i];\n        for (var prop in source) {\n            if (Object.prototype.hasOwnProperty.call(source, prop)) {\n                target[prop] = source[prop];\n            }\n        }\n    }\n    return target;\n};\n\nexport function __extends(d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport function __decorate(decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __metadata(k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n}\n\nexport function __param(paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator.throw(value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments)).next());\n    });\n}\n","/**\r\n * Copyright (c) 2016 Dmitry Panyushkin\r\n * Available under MIT license\r\n */\r\nimport * as ko from \"knockout\";\r\nimport * as qs from \"qs\";\r\n\r\nexport const arrayFirst = ko.utils.arrayFirst;\r\nexport const objectForEach = ko.utils.objectForEach;\r\nexport const extend = ko.utils.extend;\r\n\r\nexport function inherit<T, U>(target: T, source: U): T & U {\r\n    if (source) {\r\n        for (let prop in source) {\r\n            if (source.hasOwnProperty(prop) && !target.hasOwnProperty(prop)) {\r\n                target[prop] = source[prop];\r\n            }\r\n        }\r\n    }\r\n    return target as any;\r\n}\r\n\r\nexport function startsWith(str: string, search: string): boolean {\r\n    search = String(search);\r\n    let length = search.length;\r\n    return length === 0 || str.substr(0, length) === search;\r\n}\r\n\r\nexport function endsWith(str: string, search: string): boolean {\r\n    search = String(search);\r\n    let length = search.length;\r\n    return length === 0 || str.substr(-length) === search;\r\n}\r\n\r\nexport class RouterTag { }\r\n\r\nexport function getParentRouter(bindingContext: ko.BindingContext<any>): any {\r\n    return arrayFirst(bindingContext.$parents, vm => vm instanceof RouterTag);\r\n}\r\n\r\nexport function getPath(url: string): string {\r\n    return url.split(\"#\")[0].split(\"?\")[0];\r\n}\r\n\r\nexport function getUrl({ pathname, search, hash }): string {\r\n    return pathname + search + (hash || \"\");\r\n}\r\n\r\nexport function resolveUrl(rootUrl = \"\", path = \"\", query = null) {\r\n    return (startsWith(path, \"~/\") ? rootUrl + path.substr(1) : path)\r\n         + (query ? \"?\" + qs.stringify(ko.toJS(query)) : \"\");\r\n}\r\n\r\nexport function eventWhich(event): number {\r\n    event = event || window.event;\r\n    return null === event.which ? event.button : event.which;\r\n}\r\n\r\nexport function sameOrigin(href): boolean {\r\n    let origin = location.protocol + \"//\" + location.hostname;\r\n    if (location.port) {\r\n        origin += \":\" + location.port;\r\n    }\r\n    return href && (0 === href.indexOf(origin));\r\n}\r\n\r\nconst bindingProvider = new ko.bindingProvider();\r\nconst bindingOptions = { bindingParams: true };\r\n\r\nexport type ParamsBindings = Object & { [name: string]: any };\r\n\r\nexport function getParamsBindings(\r\n    element: Element, context: ko.BindingContext<any>\r\n): ParamsBindings {\r\n    let paramsString = element.getAttribute(\"params\");\r\n    if (!paramsString) {\r\n        return {};\r\n    }\r\n    return bindingProvider.parseBindingsString(\r\n        paramsString, context, element, bindingOptions\r\n    );\r\n}","/**\r\n * Copyright (c) 2016 Dmitry Panyushkin\r\n * Available under MIT license\r\n */\r\nimport * as ko from \"knockout\";\r\nimport * as pathToRegexp from \"path-to-regexp\";\r\nimport * as qs from \"qs\";\r\nimport { RouteContext } from \"./context.ts\";\r\nimport { ParamsBindings, getParamsBindings, extend } from \"./utils.ts\";\r\n\r\n// work-around typescript commonjs module export\r\nconst _pathToRegexp = (pathToRegexp as any).default;\r\n\r\nexport type Action = (context: RouteContext) => Promise<void> | void;\r\n\r\nexport class Route {\r\n    component: string;\r\n    route: string;\r\n    action: Action;\r\n    context: RouteContext;\r\n    restParams: ParamsBindings;\r\n\r\n    private re: pathToRegexp.PathRegExp;\r\n    private keys: (string | number)[];\r\n\r\n    constructor(\r\n        node: Element,\r\n        bindingContext: ko.BindingContext<any>,\r\n        routePrefix: string,\r\n        actions: Object\r\n    ) {\r\n        this.component = ko.components.getComponentNameForNode(node);\r\n        this.restParams = getParamsBindings(node, bindingContext);\r\n\r\n        let { route, action } = this.restParams;\r\n        delete this.restParams['route'];\r\n        delete this.restParams['action'];\r\n\r\n        route = route \r\n            || node.getAttribute(\"data-route\")\r\n            || node.getAttribute(\"route\") ;\r\n        action = action\r\n            || node.getAttribute(\"data-action\")\r\n            || node.getAttribute(\"action\");\r\n        \r\n        this.route = routePrefix + route;\r\n        this.action = noop;\r\n\r\n        if (typeof action === \"function\") {\r\n            this.action = action;\r\n        } else if (typeof action === \"string\") {\r\n            if (actions.hasOwnProperty(action)) {\r\n                this.action = actions[action];\r\n            } else {\r\n                ko.components.defaultLoader.getConfig(this.component, config => {\r\n                    if (config.hasOwnProperty(action)) {\r\n                        this.action = config[action];\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        this.re = _pathToRegexp(this.route);\r\n        this.keys = this.re.keys.map(k => k.name);\r\n    }\r\n\r\n    dispatch(url: string): boolean {\r\n        let [path, queryString] = url.split(\"?\");\r\n        let matches = this.re.exec(path);\r\n        if (!matches) {\r\n            return false;\r\n        }\r\n        \r\n        let params = {};\r\n        for (let i = 1; i < matches.length; ++i) {\r\n            params[this.keys[i - 1]] = matches[i];\r\n        }\r\n\r\n        extend(params, qs.parse(queryString));\r\n\r\n        this.context = {\r\n            params: params,\r\n            state: null,\r\n            route: this.route,\r\n            url: matches[0],\r\n        };\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nfunction noop() {}","/**\r\n * Copyright (c) 2016 Dmitry Panyushkin\r\n * Available under MIT license\r\n */\r\nimport * as ko from \"knockout\";\r\nimport {\r\n    RouterTag, getParentRouter,\r\n    resolveUrl, eventWhich, getUrl\r\n} from  \"./utils.ts\";\r\nimport { navigate } from \"./router.ts\";\r\n\r\n// 'query:' and 'activePathCss:' bindings works only with 'path:' binding together\r\nko.bindingHandlers['path'] = {\r\n    init(el, va, ab, vm, ctx) { \r\n        applyBinding.call(this, el, ab, ctx);\r\n    }\r\n};\r\n\r\nexport const bindingsCurrentPath = ko.observable(location.pathname);\r\n\r\nfunction applyBinding(\r\n    el: Element,\r\n    allBindings: ko.AllBindingsAccessor,\r\n    ctx: ko.BindingContext<any>\r\n) {\r\n    let router = getParentRouter(ko.contextFor(el));\r\n    let rootUrl = router && router.rootUrl || \"\";\r\n    let bindingsToApply = {};\r\n\r\n    let url = ko.pureComputed(() => resolveUrl(\r\n        rootUrl, allBindings.get(\"path\"), allBindings.get(\"query\")\r\n    ));\r\n\r\n    if (el.tagName.toLocaleUpperCase() === \"A\") {\r\n        bindingsToApply['attr'] = { href: url }\r\n    } else {\r\n        bindingsToApply['click'] = (data, e) => {\r\n            let debounce = 1 !== eventWhich(e);\r\n            let hasOtherTarget = el.hasAttribute(\"target\");\r\n            let hasExternalRel = el.getAttribute(\"rel\") === \"external\";\r\n            let modifierKey = e.metaKey || e.ctrlKey || e.shiftKey;\r\n\r\n            if (debounce || hasOtherTarget || hasExternalRel || modifierKey) {\r\n                return true;\r\n            }\r\n\r\n            let handled = navigate(url());\r\n            if (handled) {\r\n                e.preventDefault()\r\n                e.stopImmediatePropagation()\r\n            }\r\n            return !handled;\r\n        };\r\n    }\r\n\r\n    let activePathCss = allBindings.get(\"activePathCss\");\r\n    if (activePathCss) {\r\n        let path = ko.pureComputed(() => resolveUrl(\r\n            rootUrl, allBindings.get(\"path\")\r\n        ));\r\n\r\n        bindingsToApply['css'] = {\r\n            [activePathCss]: ko.pureComputed(() => path() === bindingsCurrentPath())\r\n        };\r\n    }\r\n\r\n    // allow adjacent routers to initialize\r\n    ko.tasks.schedule(() => ko.applyBindingsToNode(el, bindingsToApply, ctx));\r\n}","/**\r\n * Copyright (c) 2016 Dmitry Panyushkin\r\n * Available under MIT license\r\n */\r\nimport * as ko from \"knockout\";\r\nimport {\r\n    RouterTag, getParentRouter, arrayFirst, inherit, \r\n    getUrl, getPath, eventWhich, sameOrigin\r\n} from \"./utils.ts\";\r\nimport { RouteContext, ComponentParams } from \"./context.ts\";\r\nimport { Route, Action } from \"./route.ts\";\r\nimport { bindingsCurrentPath } from \"./bindings.ts\";\r\n\r\nconst CLICK_EVENT = typeof document !== \"undefined\" && document.ontouchstart\r\n    ? \"touchstart\" : \"click\";\r\n\r\nconst ROUTERS: Router[] = [];\r\n\r\nlet NAV_REQ_NUMBER = 0;\r\n\r\nexport interface RouterOptions {\r\n    rootUrl?: string,\r\n    routePrefix?: string,\r\n    onNavStart: () => void,\r\n    onNavFinish: () => void,\r\n    actions?: Object & {\r\n        [key: string]: Action,\r\n    }\r\n}\r\n\r\nclass Router extends RouterTag {\r\n    rootUrl: string;\r\n    routePrefix: string;\r\n    onNavStart: () => void;\r\n    onNavFinish: () => void;\r\n    actions: Object;\r\n    route: Route = null;\r\n    navReqNumber: number;\r\n    \r\n    private routes: Route[] = [];\r\n    private binding = ko.observable<{\r\n        name: string,\r\n        params: ComponentParams,\r\n    }>();\r\n    \r\n    constructor(element: Element, routeNodes: Element[], { \r\n        rootUrl, routePrefix, onNavStart, onNavFinish, actions\r\n    }: RouterOptions) {\r\n        super();\r\n\r\n        ROUTERS.push(this);\r\n        if (ROUTERS.length === 1) {\r\n            addEventListener(CLICK_EVENT, onLinkClick, false);\r\n            addEventListener(\"popstate\", onPopState, false);\r\n        }\r\n\r\n        rootUrl = rootUrl\r\n            || element.getAttribute(\"data-rootUrl\")\r\n            || element.getAttribute(\"rootUrl\");\r\n        routePrefix = routePrefix\r\n            || element.getAttribute(\"data-routePrefix\") \r\n            || element.getAttribute(\"routePrefix\");\r\n\r\n        let bindingContext = ko.contextFor(element);\r\n        let parentRouter = getParentRouter(bindingContext) as Router;\r\n\r\n        if (!parentRouter) {\r\n            this.rootUrl = rootUrl || \"\";\r\n            this.routePrefix = this.rootUrl + (routePrefix || \"\");\r\n            this.actions = actions || {};\r\n            this.navReqNumber = NAV_REQ_NUMBER;\r\n        } else {\r\n            if (typeof rootUrl === \"string\") {\r\n                throw new Error(\"Only top-level router can specify 'rootUrl'\");\r\n            }\r\n            // inherited from parent\r\n            this.rootUrl = parentRouter.rootUrl;\r\n            // concatenated with parent\r\n            this.routePrefix = parentRouter.routePrefix + (routePrefix || \"\");\r\n            // inherited from parent\r\n            this.actions = inherit(actions || {}, parentRouter.actions);\r\n            // inherited from parent\r\n            this.navReqNumber = parentRouter.navReqNumber;\r\n        }\r\n        this.onNavStart = onNavStart || noop;\r\n        this.onNavFinish = onNavFinish || noop;\r\n\r\n        this.routes = routeNodes.map(node => new Route(\r\n            node, bindingContext, this.routePrefix, this.actions\r\n        ));\r\n\r\n        this.dispatchAndNavigate(getUrl(location));\r\n    }\r\n\r\n    dispose() {\r\n        ROUTERS.splice(ROUTERS.indexOf(this), 1);\r\n        if (ROUTERS.length === 0) {\r\n            removeEventListener(CLICK_EVENT, onLinkClick, false);\r\n            removeEventListener(\"popstate\", onPopState, false);\r\n        }\r\n    }\r\n\r\n    dispatch(url: string) {\r\n        this.onNavStart();\r\n\r\n        this.route = arrayFirst(this.routes, route => route.dispatch(url));\r\n        if (!this.route) {\r\n            return;\r\n        }\r\n\r\n        let binding = this.binding();\r\n        let { component, context, action } = this.route;\r\n\r\n        if (binding && binding.name === component) {\r\n            context.state = binding.params.state();\r\n        }\r\n\r\n        return action(context) as Promise<void>;\r\n    }\r\n\r\n    navigate() {\r\n        if (this.navReqNumber !== NAV_REQ_NUMBER) {\r\n            return;\r\n        }\r\n        if (!this.route) {\r\n            this.binding(null);\r\n            this.onNavFinish();\r\n            return;\r\n        }\r\n        \r\n        let { component, context, restParams } = this.route;\r\n        let binding = this.binding();\r\n\r\n        if (binding && binding.name === component) {\r\n            binding.params.update(context);\r\n        } else {\r\n            this.binding({\r\n                name: component,\r\n                params: new ComponentParams(context, restParams),\r\n            });\r\n            ko.tasks.runEarly();\r\n        }\r\n\r\n        this.route = null;\r\n        this.onNavFinish();\r\n    }\r\n\r\n    dispatchAndNavigate(url: string) {\r\n        let promise = this.dispatch(url);\r\n        if (!promise) {\r\n            this.navigate();\r\n        } else {\r\n            promise.then(() => { this.navigate() });\r\n        }\r\n    }\r\n}\r\n\r\nexport function navigate(url: string, replace = false): boolean {\r\n    // pending navigation request can be aborted by subsequent navigate call\r\n    let navReqNumber = ++NAV_REQ_NUMBER;\r\n\r\n    let promises = ROUTERS\r\n        .map(router => router.dispatch(url))\r\n        .filter(promise => !!promise);\r\n\r\n    let status = !!arrayFirst(ROUTERS, router => !!router.route);\r\n    \r\n    // TODO: store and load history state\r\n    if (status && typeof history !== \"undefined\") {\r\n        if (replace) {\r\n            history.replaceState(null, null, url);\r\n        } else {\r\n            history.pushState(null, null, url);\r\n        }\r\n    }\r\n\r\n    let applyNavigation = () => {\r\n        if (navReqNumber !== NAV_REQ_NUMBER) {\r\n            return;\r\n        }\r\n        ROUTERS.forEach(router => {\r\n            router.navReqNumber = NAV_REQ_NUMBER; \r\n            router.navigate();\r\n        });\r\n        if (status) {\r\n            bindingsCurrentPath(getPath(url));\r\n        }\r\n    };\r\n\r\n    if (promises.length == 0) {\r\n        applyNavigation();\r\n    } else {\r\n        Promise.all(promises).then(applyNavigation);\r\n    }\r\n    return status;\r\n}\r\n\r\n// Safari and Crome before v.34 triggers \"popstate\" event\r\n// immediately after widow \"load\" event\r\nlet popStateOnLoad = true;\r\n\r\naddEventListener(\"load\", () => {\r\n    setTimeout(() => { popStateOnLoad = false; })\r\n});\r\n\r\nfunction onPopState(event: PopStateEvent) {\r\n    if (popStateOnLoad || event.defaultPrevented) {\r\n        return;\r\n    }\r\n    if (navigate(getUrl(location), true)) {\r\n        event.preventDefault();\r\n    }\r\n}\r\n\r\nfunction onLinkClick(event: MouseEvent) {\r\n    let target = event.target as HTMLAnchorElement;\r\n    while (target && \"A\" !== target.nodeName) {\r\n        target = target.parentNode as HTMLAnchorElement;\r\n    }\r\n    if (!target || \"A\" !== target.nodeName) {\r\n        return; \r\n    }\r\n\r\n    const isDoubleClick = 1 !== eventWhich(event);\r\n    const hasModifier = event.metaKey || event.ctrlKey || event.shiftKey;\r\n    const isDownload = target.hasAttribute(\"download\");\r\n    const hasOtherTarget = target.hasAttribute(\"target\");\r\n    const hasExternalRel = target.getAttribute(\"rel\") === \"external\";\r\n    const isMailto = ~(target.getAttribute(\"href\") || \"\").indexOf(\"mailto:\");\r\n    const isCrossOrigin = !sameOrigin(target.href);\r\n    const isEmptyHash = target.getAttribute(\"href\") === \"#\";\r\n\r\n    if (isCrossOrigin || isDoubleClick || isDownload || isEmptyHash ||\r\n        isMailto || hasExternalRel || hasModifier || hasOtherTarget\r\n    ) {\r\n        return;\r\n    }\r\n\r\n    if (navigate(getUrl(target))) {\r\n         event.preventDefault();\r\n    }\r\n}\r\n\r\nfunction noop() {}\r\n\r\nko.components.register(\"knockout-router\", {\r\n    synchronous: true,\r\n    viewModel: {\r\n        createViewModel: (params, { element, templateNodes }) => {\r\n            return new Router(\r\n                element as Element,\r\n                templateNodes.filter(n => n.nodeType === 1) as Element[],\r\n                params as any\r\n            );\r\n        },\r\n    },\r\n    template: `<div data-bind=\"if: binding\"><div data-bind=\"component: binding\"></div></div>`,\r\n});","'use strict';\n\nvar hexTable = (function () {\n    var array = new Array(256);\n    for (var i = 0; i < 256; ++i) {\n        array[i] = '%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase();\n    }\n\n    return array;\n}());\n\nexports.arrayToObject = function (source, options) {\n    var obj = options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nexports.merge = function (target, source, options) {\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (Array.isArray(target)) {\n            target.push(source);\n        } else if (typeof target === 'object') {\n            target[source] = true;\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (Array.isArray(target) && !Array.isArray(source)) {\n        mergeTarget = exports.arrayToObject(target, options);\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (Object.prototype.hasOwnProperty.call(acc, key)) {\n            acc[key] = exports.merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nexports.decode = function (str) {\n    try {\n        return decodeURIComponent(str.replace(/\\+/g, ' '));\n    } catch (e) {\n        return str;\n    }\n};\n\nexports.encode = function (str) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = typeof str === 'string' ? str : String(str);\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D || // -\n            c === 0x2E || // .\n            c === 0x5F || // _\n            c === 0x7E || // ~\n            (c >= 0x30 && c <= 0x39) || // 0-9\n            (c >= 0x41 && c <= 0x5A) || // a-z\n            (c >= 0x61 && c <= 0x7A) // A-Z\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        out += hexTable[0xF0 | (c >> 18)] + hexTable[0x80 | ((c >> 12) & 0x3F)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nexports.compact = function (obj, references) {\n    if (typeof obj !== 'object' || obj === null) {\n        return obj;\n    }\n\n    var refs = references || [];\n    var lookup = refs.indexOf(obj);\n    if (lookup !== -1) {\n        return refs[lookup];\n    }\n\n    refs.push(obj);\n\n    if (Array.isArray(obj)) {\n        var compacted = [];\n\n        for (var i = 0; i < obj.length; ++i) {\n            if (obj[i] && typeof obj[i] === 'object') {\n                compacted.push(exports.compact(obj[i], refs));\n            } else if (typeof obj[i] !== 'undefined') {\n                compacted.push(obj[i]);\n            }\n        }\n\n        return compacted;\n    }\n\n    var keys = Object.keys(obj);\n    for (var j = 0; j < keys.length; ++j) {\n        var key = keys[j];\n        obj[key] = exports.compact(obj[key], refs);\n    }\n\n    return obj;\n};\n\nexports.isRegExp = function (obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nexports.isBuffer = function (obj) {\n    if (obj === null || typeof obj === 'undefined') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n","'use strict';\n\nvar Utils = require('./utils');\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) {\n        return prefix + '[]';\n    },\n    indices: function indices(prefix, key) {\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) {\n        return prefix;\n    }\n};\n\nvar defaults = {\n    delimiter: '&',\n    strictNullHandling: false,\n    skipNulls: false,\n    encode: true,\n    encoder: Utils.encode\n};\n\nvar stringify = function stringify(object, prefix, generateArrayPrefix, strictNullHandling, skipNulls, encoder, filter, sort, allowDots) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = obj.toISOString();\n    } else if (obj === null) {\n        if (strictNullHandling) {\n            return encoder ? encoder(prefix) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (typeof obj === 'string' || typeof obj === 'number' || typeof obj === 'boolean' || Utils.isBuffer(obj)) {\n        if (encoder) {\n            return [encoder(prefix) + '=' + encoder(obj)];\n        }\n        return [prefix + '=' + String(obj)];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (Array.isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        if (Array.isArray(obj)) {\n            values = values.concat(stringify(obj[key], generateArrayPrefix(prefix, key), generateArrayPrefix, strictNullHandling, skipNulls, encoder, filter, sort, allowDots));\n        } else {\n            values = values.concat(stringify(obj[key], prefix + (allowDots ? '.' + key : '[' + key + ']'), generateArrayPrefix, strictNullHandling, skipNulls, encoder, filter, sort, allowDots));\n        }\n    }\n\n    return values;\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = opts || {};\n    var delimiter = typeof options.delimiter === 'undefined' ? defaults.delimiter : options.delimiter;\n    var strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n    var skipNulls = typeof options.skipNulls === 'boolean' ? options.skipNulls : defaults.skipNulls;\n    var encode = typeof options.encode === 'boolean' ? options.encode : defaults.encode;\n    var encoder = encode ? (typeof options.encoder === 'function' ? options.encoder : defaults.encoder) : null;\n    var sort = typeof options.sort === 'function' ? options.sort : null;\n    var allowDots = typeof options.allowDots === 'undefined' ? false : options.allowDots;\n    var objKeys;\n    var filter;\n\n    if (options.encoder !== null && options.encoder !== undefined && typeof options.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (Array.isArray(options.filter)) {\n        objKeys = filter = options.filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (options.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = options.arrayFormat;\n    } else if ('indices' in options) {\n        arrayFormat = options.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (sort) {\n        objKeys.sort(sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        keys = keys.concat(stringify(obj[key], key, generateArrayPrefix, strictNullHandling, skipNulls, encoder, filter, sort, allowDots));\n    }\n\n    return keys.join(delimiter);\n};\n","'use strict';\n\nvar Utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar defaults = {\n    delimiter: '&',\n    depth: 5,\n    arrayLimit: 20,\n    parameterLimit: 1000,\n    strictNullHandling: false,\n    plainObjects: false,\n    allowPrototypes: false,\n    allowDots: false,\n    decoder: Utils.decode\n};\n\nvar parseValues = function parseValues(str, options) {\n    var obj = {};\n    var parts = str.split(options.delimiter, options.parameterLimit === Infinity ? undefined : options.parameterLimit);\n\n    for (var i = 0; i < parts.length; ++i) {\n        var part = parts[i];\n        var pos = part.indexOf(']=') === -1 ? part.indexOf('=') : part.indexOf(']=') + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part);\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos));\n            val = options.decoder(part.slice(pos + 1));\n        }\n        if (has.call(obj, key)) {\n            obj[key] = [].concat(obj[key]).concat(val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function parseObject(chain, val, options) {\n    if (!chain.length) {\n        return val;\n    }\n\n    var root = chain.shift();\n\n    var obj;\n    if (root === '[]') {\n        obj = [];\n        obj = obj.concat(parseObject(chain, val, options));\n    } else {\n        obj = options.plainObjects ? Object.create(null) : {};\n        var cleanRoot = root[0] === '[' && root[root.length - 1] === ']' ? root.slice(1, root.length - 1) : root;\n        var index = parseInt(cleanRoot, 10);\n        if (\n            !isNaN(index) &&\n            root !== cleanRoot &&\n            String(index) === cleanRoot &&\n            index >= 0 &&\n            (options.parseArrays && index <= options.arrayLimit)\n        ) {\n            obj = [];\n            obj[index] = parseObject(chain, val, options);\n        } else {\n            obj[cleanRoot] = parseObject(chain, val, options);\n        }\n    }\n\n    return obj;\n};\n\nvar parseKeys = function parseKeys(givenKey, val, options) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^\\.\\[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var parent = /^([^\\[\\]]*)/;\n    var child = /(\\[[^\\[\\]]*\\])/g;\n\n    // Get the parent\n\n    var segment = parent.exec(key);\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (segment[1]) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, segment[1])) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(segment[1]);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].replace(/\\[|\\]/g, ''))) {\n            if (!options.allowPrototypes) {\n                continue;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options);\n};\n\nmodule.exports = function (str, opts) {\n    var options = opts || {};\n\n    if (options.decoder !== null && options.decoder !== undefined && typeof options.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    options.delimiter = typeof options.delimiter === 'string' || Utils.isRegExp(options.delimiter) ? options.delimiter : defaults.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : defaults.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : defaults.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.decoder = typeof options.decoder === 'function' ? options.decoder : defaults.decoder;\n    options.allowDots = typeof options.allowDots === 'boolean' ? options.allowDots : defaults.allowDots;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : defaults.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : defaults.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : defaults.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options);\n        obj = Utils.merge(obj, newObj, options);\n    }\n\n    return Utils.compact(obj);\n};\n","'use strict';\n\nvar Stringify = require('./stringify');\nvar Parse = require('./parse');\n\nmodule.exports = {\n    stringify: Stringify,\n    parse: Parse\n};\n","/**\r\n * Copyright (c) 2016 Dmitry Panyushkin\r\n * Available under MIT license\r\n */\r\nimport * as ko from \"knockout\";\r\nimport { ParamsBindings, inherit, objectForEach } from \"./utils.ts\";\r\n\r\nexport interface RouteContext {\r\n    params: Object & {\r\n        [key: string]: any\r\n    },\r\n    state: any,\r\n    route: any,\r\n    url: any,\r\n}\r\n\r\nexport class ComponentParams implements RouteContext {\r\n    params: Object & {\r\n        [key: string]: ko.Observable<any>\r\n    } = {};\r\n    state = ko.observable<any>();\r\n    route = ko.observable<string>();\r\n    url = ko.observable<string>();\r\n\r\n    constructor(context: RouteContext, restParams: ParamsBindings) {\r\n        this.update(context);\r\n        inherit(this, restParams);\r\n    }\r\n\r\n    update(context: RouteContext) {\r\n        let { params, state, route, url } = context;\r\n        objectForEach(params, (key, value) => {\r\n            let observable = this.params[key];\r\n            if (observable) {\r\n                observable(value);\r\n            } else {\r\n                this.params[key] = ko.observable(value);\r\n            }\r\n        });\r\n        objectForEach(this.params, (key, observable) => {\r\n            if (!params.hasOwnProperty(key)) {\r\n                observable(null);\r\n            }\r\n        })\r\n        this.state(state);\r\n        this.route(route);\r\n        this.url(url);\r\n    }\r\n}","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string} str\n * @return {!Array}\n */\nfunction parse (str) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    var next = str[index]\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var modifier = res[6]\n    var asterisk = res[7]\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var partial = prefix != null && next != null && next !== prefix\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var delimiter = res[2] || '/'\n    var pattern = capture || group || (asterisk ? '.*' : '[^' + delimiter + ']+?')\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: escapeGroup(pattern)\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str) {\n  return tokensToFunction(parse(str))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$')\n    }\n  }\n\n  return function (obj, opts) {\n    var path = ''\n    var data = obj || {}\n    var options = opts || {}\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  var tokens = parse(path)\n  var re = tokensToRegExp(tokens, options)\n\n  // Attach keys back to the regexp.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] !== 'string') {\n      keys.push(tokens[i])\n    }\n  }\n\n  return attachKeys(re, keys)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}  tokens\n * @param  {Object=} options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, options) {\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n  var lastToken = tokens[tokens.length - 1]\n  var endsWithSlash = typeof lastToken === 'string' && /\\/$/.test(lastToken)\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = '(?:' + token.pattern + ')'\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = prefix + '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithSlash ? route.slice(0, -2) : route) + '(?:\\\\/(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithSlash ? '' : '(?=\\\\/|$)'\n  }\n\n  return new RegExp('^' + route, flags(options))\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  keys = keys || []\n\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys)\n    keys = []\n  } else if (!options) {\n    options = {}\n  }\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n"],"names":["__extends","d","b","__","this","constructor","p","hasOwnProperty","prototype","Object","create","target","source","prop","str","search","String","length","substr","bindingContext","arrayFirst","$parents","vm","RouterTag","url","split","_a","pathname","hash","rootUrl","path","query","startsWith","qs.stringify","ko","toJS","event","window","which","button","href","origin","location","protocol","hostname","port","indexOf","element","context","paramsString","getAttribute","bindingProvider","parseBindingsString","bindingOptions","el","allBindings","ctx","router","getParentRouter","contextFor","bindingsToApply","pureComputed","resolveUrl","get","tagName","toLocaleUpperCase","data","e","debounce","eventWhich","hasOtherTarget","hasAttribute","hasExternalRel","modifierKey","metaKey","ctrlKey","shiftKey","handled","navigate","preventDefault","stopImmediatePropagation","activePathCss","path_1","bindingsCurrentPath","tasks","schedule","applyBindingsToNode","replace","navReqNumber","NAV_REQ_NUMBER","promises","ROUTERS","map","dispatch","filter","promise","status","route","history","replaceState","pushState","applyNavigation","forEach","getPath","Promise","all","then","popStateOnLoad","defaultPrevented","getUrl","nodeName","parentNode","isDoubleClick","hasModifier","isDownload","isMailto","isCrossOrigin","sameOrigin","isEmptyHash","hexTable","array","Array","i","toString","toUpperCase","exports","arrayToObject","options","obj","plainObjects","merge","isArray","push","concat","mergeTarget","keys","reduce","acc","key","value","call","decode","decodeURIComponent","encode","string","out","c","charCodeAt","charAt","compact","references","refs","lookup","compacted","j","isRegExp","isBuffer","Utils","commonjsHelpers.interopDefault","arrayPrefixGenerators","brackets","prefix","indices","repeat","defaults","delimiter","strictNullHandling","skipNulls","encoder","stringify","object","generateArrayPrefix","sort","allowDots","Date","toISOString","values","objKeys","module","opts","undefined","TypeError","arrayFormat","join","has","depth","arrayLimit","parameterLimit","allowPrototypes","decoder","parseValues","parts","Infinity","val","part","pos","slice","parseObject","chain","root","shift","cleanRoot","index","parseInt","isNaN","parseArrays","parseKeys","givenKey","parent","child","segment","exec","tempObj","newObj","Stringify","Parse","parse","utils","objectForEach","extend","bindingParams","restParams","observable","update","inherit","ComponentParams","state","params","_this","arr","res","tokens","PATH_REGEXP","m","escaped","offset","next","name","capture","group","modifier","asterisk","partial","optional","pattern","escapeGroup","compile","tokensToFunction","encodeURIComponentPretty","encodeURI","encodeAsterisk","matches","RegExp","pretty","encodeURIComponent","token","isarray","JSON","test","escapeString","attachKeys","re","flags","sensitive","regexpToRegexp","groups","match","arrayToRegexp","pathToRegexp","regexp","stringToRegexp","tokensToRegExp","strict","end","lastToken","endsWithSlash","_pathToRegexp","pathToRegexp.default","node","routePrefix","actions","component","components","getComponentNameForNode","getParamsBindings","action","noop","defaultLoader","getConfig","config","k","Route","queryString","qs.parse","bindingHandlers","init","va","ab","applyBinding","CLICK_EVENT","document","ontouchstart","routeNodes","onNavStart","onNavFinish","_super","addEventListener","onLinkClick","onPopState","parentRouter","Error","routes","dispatchAndNavigate","Router","splice","removeEventListener","binding","runEarly","setTimeout","register","synchronous","viewModel","createViewModel","templateNodes","n","nodeType","template"],"mappings":"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"}